{"config":{"lang":["en"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"]},"docs":[{"location":"","title":"Welcome to MkDocs","text":"<p>For full documentation visit mkdocs.org.</p>"},{"location":"#commands","title":"Commands","text":"<ul> <li><code>mkdocs new [dir-name]</code> - Create a new project.</li> <li><code>mkdocs serve</code> - Start the live-reloading docs server.</li> <li><code>mkdocs build</code> - Build the documentation site.</li> <li><code>mkdocs -h</code> - Print help message and exit.</li> </ul>"},{"location":"#project-layout","title":"Project layout","text":"<pre><code>mkdocs.yml    # The configuration file.\ndocs/\n    index.md  # The documentation homepage.\n    ...       # Other markdown pages, images and other files.\n</code></pre>"},{"location":"Build/","title":"Build","text":"<p>Instructions on how to build</p>"},{"location":"Engine/Engine/","title":"Engine","text":""},{"location":"Engine/Engine/#project-layout","title":"Project layout","text":"<pre><code>mkdocs.yml    # The configuration file.\ndocs/\n    index.md  # The documentation homepage.\n    ...       # Other markdown pages, images and other files.\n</code></pre>"},{"location":"Engine/3D/SGD/","title":"SGD","text":"<p>hello</p>"},{"location":"Game/GPhaseSystem/","title":"Summary","text":"<p>The gaame uses a <code>GPhaseSystem</code> to split the logic into game sections. It is located under the gphase.cpp file. Please take not that all the following information is pulled from the EU version. The EU version has a few more states than the US/JP versions:</p> <ol> <li>A language selection upon first boot</li> <li>A screen refresh rate selector</li> <li>A boot video of Ubisoft's logo</li> </ol>"},{"location":"Game/GPhaseSystem/#basic-components","title":"Basic Components","text":""},{"location":"Game/GPhaseSystem/#game-phases","title":"Game Phases","text":"<p>In Fatal Frame 2, a <code>Game Phase (GPhase)</code> represents the current action (phase) the game is currently performing. Each phase serves to handle a particular part of the game such as loading the game, menu traversal, selecting a lanaguage, and so on... A <code>GPhase</code> is represented by a <code>GPHASE_ID_ENUM</code>, an enum that contains all possible game phases (see list below). Those phases also have handler functions that will contain all code to perform the action!</p> List Of GPhases <pre><code>/// Game Phases (GPHASE) of the game.\n/// Used to layout the game logic and group functions goals.\nenum GPHASE_ID_ENUM : int\n{\nGID_SUPER                     = 0,\nGID_BOOT_INIT                 = 1,\nGID_BOOT_PADCHECK             = 2, /// EU ONLY\nGID_LANGDATA_CHECK            = 3, /// EU ONLY\nGID_LANGSEL_MAIN              = 4, /// EU ONLY\nGID_AUTOLOAD_MAIN             = 5,\nGID_UBI_MODE                  = 6, /// EU ONLY\nGID_OUTGAME_MAIN              = 7,\nGID_STORY_MAIN                = 8,\nGID_GAMEOVER_MENU             = 9,\nGID_ENDING_MOVIE              = 10,\nGID_GAMERESULT                = 11,\nGID_CLEARMENU                 = 12,\nGID_SOFTRESETMAIN             = 13,\nGID_DEBUG_MENU                = 14,\nGID_TECMO_MODE                = 15,\nGID_PROJECT_MODE              = 16,\nGID_TITLE_MODE                = 17,\nGID_TITLE_MOVIE_MODE          = 18,\nGID_STORY_NOWLOADING          = 19,\nGID_STORY_NORMAL              = 20,\nGID_STORY_DAMAGE              = 21,\nGID_STORY_DOOR_OPEN           = 22,\nGID_STORY_DEBUG               = 23,\nGID_STORY_DEBUG_CAM           = 24,\nGID_STORY_PAUSE               = 25,\nGID_STORY_PAUSE_MISSION       = 26,\nGID_STORY_MENU                = 27,\nGID_STORY_MAP                 = 28,\nGID_STORY_MISSION_ST          = 29,\nGID_STORY_MISSION_RESULT      = 30,\nGID_STORY_GAME_OVER_PRE       = 31,\nGID_STORY_GAME_OVER           = 32,\nGID_STORY_SCENE               = 33,\nGID_STORY_MOVIE               = 34,\nGID_STORY_EFFECT              = 35,\nGID_EVENTMSG_DISP             = 36,\nGID_EVENTFILE_DISP            = 37,\nGID_STORY_PHOTO               = 38,\nGID_STORY_ENE_DEAD            = 39,\nGID_STORY_PUZZLE              = 40,\nGID_STORY_SAVEPOINT           = 41,\nGID_STORY_MOVIE_ROOM_SEL      = 42,\nGID_GAMEOVER_MENU_TOP         = 43,\nGID_GAMEOVER_MENU_LOAD        = 44,\nGID_GAMEOVER_MENU_ALBUM       = 45,\nGID_ENDING_NORMAL1            = 46,\nGID_ENDING_NORMAL2            = 47,\nGID_ENDING_HARD               = 48,\nGID_GAMERESULT_TOP            = 49,\nGID_CLEARMENU_TOP             = 50,\nGID_CLEARMENU_SAVE            = 51,\nGID_CLEARMENU_ALBUM           = 52,\nGID_TITLE_TOP                 = 53,\nGID_TITLE_MENU                = 54,\nGID_TITLE_NEWGAME             = 55,\nGID_TITLE_LOADGAME            = 56,\nGID_TITLE_SETUP               = 57,\nGID_TITLE_ALBUM               = 58,\nGID_TITLE_GALLERY             = 59,\nGID_TITLE_OPTION              = 60,\nGID_TITLE_FRAMERATE_SEL       = 61, /// EU ONLY\nGID_TITLE_CHAPTER_SEL         = 62,\nGID_TITLE_MOVE_MOVIE          = 63, /// EU ONLY\nGID_STORY_LOAD_MISSION        = 64,\nGID_STORY_LOAD_MISSION_EVENT  = 65,\nGID_STORY_LOAD_MISSION_SAVE   = 66,\nGID_STORY_GAMEOVER_EFF        = 67,\nGID_STORY_GAMEOVER_FADE       = 68,\nGID_STORY_GAMEOVER_MOVIE      = 69,\nGID_STORY_SCENE_PRELOAD       = 70,\nGID_STORY_SCENE_MAIN          = 71,\nGID_STORY_MOVIE_PRELOAD       = 72,\nGID_STORY_MOVIE_MAIN          = 73,\nGID_PUZZLE_INCONF             = 74,\nGID_PUZZLE_CROSSFADE          = 75,\nGID_PUZZLE_HINA               = 76,\nGID_PUZZLE_ROKU               = 77,\nGID_PUZZLE_KAZA               = 78,\nGID_PUZZLE_KAZA2              = 79,\nGID_PUZZLE_KAI1               = 80,\nGID_PUZZLE_KAI2               = 81,\nGID_SAVEPOINT_FADEIN          = 82,\nGID_SAVEPOINT_MAIN            = 83,\nGID_SAVEPOINT_FADEOUT         = 84,\nGID_TITLE_SETUPMENU           = 85,\nGID_TITLE_MISSION             = 86,\nGID_SAVEPOINT_TOP             = 87,\nGID_SAVEPOINT_SAVE            = 88,\nGID_SAVEPOINT_ALBUM           = 89,\nGID_MISSION_SEL               = 90,\nGID_MISSION_CAM               = 91,\nGID_MISSION_ALBUM             = 92,\nGID_MISSION_SAVE              = 93,\nGPHASE_ID_NONE                = -1\n};\n</code></pre>"},{"location":"Game/GPhaseSystem/#layers","title":"Layers","text":"<p>In Fatal Frame 2, a layer (<code>GPHASE_LAYER</code>) represents the game's current phase in a category. Those layers regroup a collection of <code>GPHASE_ID_ENUM</code> (see Game Phases) that are related to a common section of the game. For example, some phases are related to the initialization of the game which are under the layer <code>GAME_INIT</code>. Take note that the game does not use any enum definitions for those but simply <code>int</code>. As such, I extracted this information based on my knowledge of the game. This might change later as I get a better understanding of the code.</p> The 6 Layers <pre><code>/// Regroups game logic into game modes or utilities.\nenum GPHASE_LAYER : int\n{\n/// GPHASE: 0\nSYSTEM_INIT,\n/// GPHASE: 1 - 10\nGAME_INIT,\n/// GPHASE: 11 - 48\nSTORY,\n/// GPHASE: 49 - 78\nTITLE,\n/// GPHASE: 79 - 83\nSAVE,\n/// GPHASE: 84 - 88\nMISSION\n};\n</code></pre>"},{"location":"Game/GPhaseSystem/#states","title":"States","text":"<p>A GPhase state (or <code>GPHASE_ENUM</code>) indicates the state of the game for the current frame and is usually the value returned by GPhase state handling functions (see the following section).</p> List Of GPhase Status <pre><code>enum GPHASE_ENUM : int\n{\nGPHASE_CONTINUE   = 0,\nGPHASE_END        = 1,\nGPHASE_NOFRAME    = 2\n};\n</code></pre>"},{"location":"Game/GPhaseSystem/#handler-functions","title":"Handler Functions","text":"<p>Each <code>GPHASE</code> has 4 handler methods: <code>ini_func</code>, <code>pre_func</code>, <code>after_func</code> and <code>end_func</code>. The order of execution goes as follows:</p> <ol> <li><code>ini</code> -&gt; handles initialization of variables/memory allocation</li> <li><code>pre</code> -&gt; handles logic before calling son</li> <li>If this phase has a son -&gt; go to step 1 for son; Otherwise continue to next step</li> <li><code>after</code> -&gt; handles logic after calling son</li> <li><code>end</code> -&gt; handles freeing allocated memory and resetting values</li> </ol> <p><code>ini_func</code> and <code>pre_func</code> have no arguments while <code>after_func</code> and <code>end_func</code> take a <code>GPHASE_ID</code> as an argument and return a value of <code>GPHASE_ENUM</code>. Only the <code>pre</code> handler can have a <code>nullptr</code> as a method. However, since this repo will not have all reversed code at the same time additionnal checks for <code>nullptr</code> have been added to other handler calls.</p> <p>When implementing a new <code>GPHASE</code>, make sure to add your functions to the array of the appropriate <code>xx_func</code> and ABSOLUTELY make sure that the function's position/index in the array is the same as the <code>GPHASE_ID</code>.</p> Sample Of Ini, End, Pre, And After Functions <pre><code>void (*ini_func[gphase_num])() =\n{\ninit_super,\ninit_Boot_Init,\n(...)\n};\nvoid (*end_func[gphase_num])() =\n{\nend_super,\nend_Boot_Init,\n(...)\n};\nGPHASE_ENUM (*pre_func[gphase_num])(GPHASE_ID) =\n{\npre_super,\nnullptr,\n(...)\n};\nGPHASE_ENUM (*after_func[gphase_num])(GPHASE_ID) =\n{\nafter_super,\none_Boot_Init,\n(...)\n};\n// Implementation of the methods defined above\nvoid init_super()\n{\nInitLogging();\nInitCostume();\nsoft_reset_disable = 0;\nInitSystemON();\nplayPssInit();\nInitLogo();\nLoadingInit();\nTitleInit();\nInitOptionSetup(&amp;opt_wrk);\n}\nvoid end_super()\n{\nreturn;\n}\nGPHASE_ENUM after_super(GPHASE_ENUM result)\n{\nEachDebugMain();\nee_iopMain();\nSendDMAMain();\nreturn (GPHASE_ENUM)(CheckSoftReset() != 0);\n}\nGPHASE_ENUM pre_super(GPHASE_ENUM super)\n{\n// Do stuff...\nreturn GPHASE_CONTINUE;\n}\n</code></pre> <p>Take note that the <code>SUPER GPHASE (GID_SUPER)</code> is at position 0/ is the first element just like its enum.</p>"},{"location":"Game/GPhaseSystem/#structured-gphase-data","title":"Structured GPhase Data","text":""},{"location":"Game/GPhaseSystem/#structure-definitions","title":"Structure Definitions","text":""},{"location":"Game/GPhaseSystem/#gphase_dat","title":"GPHASE_DAT","text":"<p>The <code>GPHASE_DAT</code> structure contains all information related to a game phase. The layer indicates to which layer a game phase belongs to. <code>superID</code> indicates the parent of that phase. <code>son_ID</code> indicates the child of a game phase and <code>son_num</code> indicates how many children a game phase has.</p> Definition Of GPHASE_DAT <pre><code>struct GPHASE_DAT\n{\nint layer;\nint superID;\nint son_ID;\nint son_num;\n};\n</code></pre>"},{"location":"Game/GPhaseSystem/#gphase_sys","title":"GPHASE_SYS","text":"<p><code>GPHASE_SYS</code> is a structure that stores the current phase of the game, the next one and some execution flag. At this moment I do not know more than that.</p> Definition Of GPHASE_SYS <pre><code>struct GPHASE_SYS\n{\nGPHASE_ID_ENUM now[gphase_sys_num];\nGPHASE_ID_ENUM next[gphase_sys_num];\nint ini_flg[gphase_sys_num];\n};\n</code></pre> Full List Of GPHASE_SYS <pre><code>const GPHASE_DAT gphase_tbl[gphase_num] = {\n/// Layers,     Supuper ID  ,           Son ID       , Son Num\n{0,       GPHASE_ID_NONE,           GID_BOOT_INIT, 14},\n{1,            GID_SUPER,          GPHASE_ID_NONE,  0},\n{1,            GID_SUPER,          GPHASE_ID_NONE,  0},\n{1,            GID_SUPER,          GPHASE_ID_NONE,  0},\n{1,            GID_SUPER,          GPHASE_ID_NONE,  0},\n{1,            GID_SUPER,          GPHASE_ID_NONE,  0},\n{1,            GID_SUPER,          GPHASE_ID_NONE,  0},\n{1,            GID_SUPER,          GID_TECMO_MODE,  4},\n{1,            GID_SUPER,    GID_STORY_NOWLOADING, 24},\n{1,            GID_SUPER,   GID_GAMEOVER_MENU_TOP,  3},\n{1,            GID_SUPER,      GID_ENDING_NORMAL1,  3},\n{1,            GID_SUPER,      GID_GAMERESULT_TOP,  1},\n{1,            GID_SUPER,       GID_CLEARMENU_TOP,  3},\n{1,            GID_SUPER,          GPHASE_ID_NONE,  0},\n{1,            GID_SUPER,          GPHASE_ID_NONE,  0},\n{2,     GID_OUTGAME_MAIN,          GPHASE_ID_NONE,  0},\n{2,     GID_OUTGAME_MAIN,          GPHASE_ID_NONE,  0},\n{2,     GID_OUTGAME_MAIN,           GID_TITLE_TOP, 11},\n{2,     GID_OUTGAME_MAIN,          GPHASE_ID_NONE,  0},\n{2,       GID_STORY_MAIN,  GID_STORY_LOAD_MISSION,  3},\n{2,       GID_STORY_MAIN,          GPHASE_ID_NONE,  0},\n{2,       GID_STORY_MAIN,          GPHASE_ID_NONE,  0},\n{2,       GID_STORY_MAIN,          GPHASE_ID_NONE,  0},\n{2,       GID_STORY_MAIN,          GPHASE_ID_NONE,  0},\n{2,       GID_STORY_MAIN,          GPHASE_ID_NONE,  0},\n{2,       GID_STORY_MAIN,          GPHASE_ID_NONE,  0},\n{2,       GID_STORY_MAIN,          GPHASE_ID_NONE,  0},\n{2,       GID_STORY_MAIN,          GPHASE_ID_NONE,  0},\n{2,       GID_STORY_MAIN,          GPHASE_ID_NONE,  0},\n{2,       GID_STORY_MAIN,          GPHASE_ID_NONE,  0},\n{2,       GID_STORY_MAIN,          GPHASE_ID_NONE,  0},\n{2,       GID_STORY_MAIN,          GPHASE_ID_NONE,  0},\n{2,       GID_STORY_MAIN,  GID_STORY_GAMEOVER_EFF,  3},\n{2,       GID_STORY_MAIN, GID_STORY_SCENE_PRELOAD,  2},\n{2,       GID_STORY_MAIN, GID_STORY_MOVIE_PRELOAD,  2},\n{2,       GID_STORY_MAIN,          GPHASE_ID_NONE,  0},\n{2,       GID_STORY_MAIN,          GPHASE_ID_NONE,  0},\n{2,       GID_STORY_MAIN,          GPHASE_ID_NONE,  0},\n{2,       GID_STORY_MAIN,          GPHASE_ID_NONE,  0},\n{2,       GID_STORY_MAIN,          GPHASE_ID_NONE,  0},\n{2,       GID_STORY_MAIN,       GID_PUZZLE_INCONF,  8},\n{2,       GID_STORY_MAIN,    GID_SAVEPOINT_FADEIN,  3},\n{2,       GID_STORY_MAIN,          GPHASE_ID_NONE,  0},\n{2,    GID_GAMEOVER_MENU,          GPHASE_ID_NONE,  0},\n{2,    GID_GAMEOVER_MENU,          GPHASE_ID_NONE,  0},\n{2,    GID_GAMEOVER_MENU,          GPHASE_ID_NONE,  0},\n{2,     GID_ENDING_MOVIE,          GPHASE_ID_NONE,  0},\n{2,     GID_ENDING_MOVIE,          GPHASE_ID_NONE,  0},\n{2,     GID_ENDING_MOVIE,          GPHASE_ID_NONE,  0},\n{2,       GID_GAMERESULT,          GPHASE_ID_NONE,  0},\n{2,        GID_CLEARMENU,          GPHASE_ID_NONE,  0},\n{2,        GID_CLEARMENU,          GPHASE_ID_NONE,  0},\n{2,        GID_CLEARMENU,          GPHASE_ID_NONE,  0},\n{3,       GID_TITLE_MODE,          GPHASE_ID_NONE,  0},\n{3,       GID_TITLE_MODE,          GPHASE_ID_NONE,  0},\n{3,       GID_TITLE_MODE,          GPHASE_ID_NONE,  0},\n{3,       GID_TITLE_MODE,          GPHASE_ID_NONE,  0},\n{3,       GID_TITLE_MODE,     GID_TITLE_SETUPMENU,  2},\n{3,       GID_TITLE_MODE,          GPHASE_ID_NONE,  0},\n{3,       GID_TITLE_MODE,          GPHASE_ID_NONE,  0},\n{3,       GID_TITLE_MODE,          GPHASE_ID_NONE,  0},\n{3,       GID_TITLE_MODE,          GPHASE_ID_NONE,  0},\n{3,       GID_TITLE_MODE,          GPHASE_ID_NONE,  0},\n{3,       GID_TITLE_MODE,          GPHASE_ID_NONE,  0},\n{3, GID_STORY_NOWLOADING,          GPHASE_ID_NONE,  0},\n{3, GID_STORY_NOWLOADING,          GPHASE_ID_NONE,  0},\n{3, GID_STORY_NOWLOADING,          GPHASE_ID_NONE,  0},\n{3,  GID_STORY_GAME_OVER,          GPHASE_ID_NONE,  0},\n{3,  GID_STORY_GAME_OVER,          GPHASE_ID_NONE,  0},\n{3,  GID_STORY_GAME_OVER,          GPHASE_ID_NONE,  0},\n{3,      GID_STORY_SCENE,          GPHASE_ID_NONE,  0},\n{3,      GID_STORY_SCENE,          GPHASE_ID_NONE,  0},\n{3,      GID_STORY_MOVIE,          GPHASE_ID_NONE,  0},\n{3,      GID_STORY_MOVIE,          GPHASE_ID_NONE,  0},\n{3,     GID_STORY_PUZZLE,          GPHASE_ID_NONE,  0},\n{3,     GID_STORY_PUZZLE,          GPHASE_ID_NONE,  0},\n{3,     GID_STORY_PUZZLE,          GPHASE_ID_NONE,  0},\n{3,     GID_STORY_PUZZLE,          GPHASE_ID_NONE,  0},\n{3,     GID_STORY_PUZZLE,          GPHASE_ID_NONE,  0},\n{3,     GID_STORY_PUZZLE,          GPHASE_ID_NONE,  0},\n{3,     GID_STORY_PUZZLE,          GPHASE_ID_NONE,  0},\n{3,     GID_STORY_PUZZLE,          GPHASE_ID_NONE,  0},\n{3,  GID_STORY_SAVEPOINT,          GPHASE_ID_NONE,  0},\n{3,  GID_STORY_SAVEPOINT,       GID_SAVEPOINT_TOP,  3},\n{3,  GID_STORY_SAVEPOINT,          GPHASE_ID_NONE,  0},\n{4,      GID_TITLE_SETUP,          GPHASE_ID_NONE,  0},\n{4,      GID_TITLE_SETUP,         GID_MISSION_SEL,  4},\n{4,   GID_SAVEPOINT_MAIN,          GPHASE_ID_NONE,  0},\n{4,   GID_SAVEPOINT_MAIN,          GPHASE_ID_NONE,  0},\n{4,   GID_SAVEPOINT_MAIN,          GPHASE_ID_NONE,  0},\n{5,    GID_TITLE_MISSION,          GPHASE_ID_NONE,  0},\n{5,    GID_TITLE_MISSION,          GPHASE_ID_NONE,  0},\n{5,    GID_TITLE_MISSION,          GPHASE_ID_NONE,  0},\n{5,    GID_TITLE_MISSION,          GPHASE_ID_NONE,  0}\n};\n</code></pre>"}]}